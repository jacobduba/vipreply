<% has_templates = @topic.templates.any? %>
<%= form_with url: send_email_topic_path(topic), method: :post, id: "generated_reply_form" do |form| %>
  <%= form.label :email, "Email reply", class: "block text-sm font-medium text-stone-600 mb-2" %>
  <%# autocomplete: "off" disabled input form caching, yeah I know stupid %>
  <% if has_templates %>
    <% placeholder_text = if topic.awaiting_customer?
                         "Awaiting on customer's reply..."
                       else
                         "Type your reply..."
                       end %>
    <%= form.text_area :email, rows: 3, value: generated_reply, data: { controller: "textbox-autoresize" }, autocomplete: "off", placeholder: placeholder_text, disabled: !has_templates, class: "block p-4 w-full text-sm rounded-lg border resize-none text-stone-900 bg-white border-stone-200 focus:ring-blue-500 focus:border-blue-500/90 focus:outline-none" %>
  <% else %>
    <div class="border-2 border-dashed border-stone-300 rounded-lg flex justify-center gap-2 items-center p-3 mb-2 text-stone-500">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155" />
      </svg>
      <p>Choose smart cards to generate a reply.</p>
    </div>
  <% end %>
  <div class="flex justify-start items-center gap-3 mt-4">
    <% if has_templates %>
      <button type="submit" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center gap-2 hover:cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
        </svg>
        Send reply
      </button>
    <% else %>
      <%= button_tag type: 'button', disabled: true, class: "text-stone-500/50 bg-stone-200/50 cursor-not-allowed font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center gap-2" do %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 text-stone-400">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
        </svg>
        Send reply
      <% end %>
    <% end %>
  </div>
<% end %>
