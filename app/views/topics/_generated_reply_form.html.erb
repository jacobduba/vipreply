<%= form_with url: send_email_topic_path(topic), method: :post, id: "generated_reply_form" do |form| %>
  <%= form.label :email, "Email reply", class: "block text-sm font-medium text-stone-600 mb-2" %>
  <%# autocomplete: "off" disabled input form caching, yeah I know stupid %>
  <% placeholder_text = if topic.awaiting_customer?
                      "Waiting on customer's reply..."
                    else
                      "Type your reply..."
                    end %>
  <%= form.text_area :email, rows: 3, value: generated_reply, data: { controller: "textbox-autoresize" }, autocomplete: "off", placeholder: placeholder_text, class: "block p-4 w-full text-sm text-stone-900 bg-white rounded-lg border border-stone-200 focus:ring-blue-500 focus:border-blue-500/90 focus:outline-none resize-none" %>
  <div class="flex justify-start items-center gap-3 mt-4">
    <button type="submit" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center gap-2 hover:cursor-pointer">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
      </svg>
      Send reply
    </button>
    <% if topic.will_autosend %>
      <div class="flex items-center text-sm text-stone-700 bg-stone-200/80 rounded-lg px-5 py-2.5 gap-2" role="alert">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="flex-shrink-0 inline size-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
        </svg>
        <span class="font-medium">Would autosend</span>
      </div>
    <% elsif topic.awaiting_customer %>
      <div class="flex items-center text-sm text-stone-700 bg-stone-200/80 rounded-lg px-5 py-2.5 gap-2" role="alert">
        <svg class="flex-shrink-0 inline size-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
        <span class="font-medium">Awaiting customer reply</span>
      </div>
    <% end %>
  </div>
<% end %>
